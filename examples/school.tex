% Copyright 2021 felsenkatze
% 
% Licensed under the Apache License, Version 2.0 (the "License");
% you may not use this file except in compliance with the License.
% You may obtain a copy of the License at
% 
%     http://www.apache.org/licenses/LICENSE-2.0
% 
% Unless required by applicable law or agreed to in writing, software
% distributed under the License is distributed on an "AS IS" BASIS,
% WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
% See the License for the specific language governing permissions and
% limitations under the License.

% A4 paper with 12pt font
\documentclass[12pt, a4paper]{article}

% load fontspec for font management
\usepackage{fontspec}
% set default font -> font must be installed on the system
\setmainfont{Liberation Mono}

% load babel for language management
\usepackage[ngerman]{babel}

% load csquotes for quoation formating
\usepackage{csquotes}
% if » is used in text, it gets interpreted as opening quote
% if « is used, ... as closing quote
\MakeAutoQuote{»}{«}
% set quote style based on used language
\setquotestyle{ngerman}
% custom commands for csquotes
\DeclareQuoteStyle{school}{\quotedblbase}{\textquotedblright}{\textquotesingle}{\textquotesingle}
\DeclareQuoteOption{school}
\setquotestyle{school}

% load graphicx for image processing
\usepackage{graphicx}

% load color used for coloring
\usepackage{color}

% load url to format urls
\usepackage{url}

% titletoc for customized table of contents
% needs to be loaded before hyperref, otherwise errors occur
\usepackage{titletoc}

\usepackage[ % load hyperref for links in the generated pdf
   colorlinks, % links in color with no border
   linkcolor=black, % internal references
   filecolor=black, % external references
   citecolor=black, % citations
   urlcolor =black, % urls
]{hyperref}
\hypersetup{pdfauthor=Felsenkatze,pdftitle=Deutsche
Küche,pdfsubject=Futtern,
}

% load geometry for cusomization of page and set margins
\usepackage[top=3cm,left=3cm,right=4cm,bottom=3cm, ]{geometry}

% load siunitx for unit formating
\usepackage{siunitx}

\usepackage[
backend=biber, 
style=authortitle-ibid,
sorting=nyt,
clearlang=true,
backref=false,
abbreviate=true,
doi=true,
url=true,
isbn=true,
useauthor=true,
usetranslator=true,
maxcitenames=1,
maxbibnames=100,
autocite=footnote,
block=none,
timezones=false,
date=year,
]{biblatex}
\addbibresource{bibliography.bib}
\DeclareDelimFormat[bib]{nametitledelim}{\addcolon\space}
\AtEveryBibitem{\clearfield{pagetotal}}
\setlength{\bibitemsep}{\baselineskip}

% load titlesec to format the section titles
\usepackage{titlesec}
\titleformat{\section} % format sections
  {\fontsize{15pt}{15pt}\selectfont\scshape}{\thesection}{0.5cm}{}
\titleformat{\subsection} % format subsections
  {\fontsize{14pt}{14pt}\selectfont\scshape}{\thesubsection}{0.5cm}{}
\titleformat{\subsubsection} % format subsubsections
  {\fontsize{13pt}{13pt}\selectfont\scshape}{\thesubsubsection}{0.5cm}{}

\renewcommand{\thesection}{\arabic{section}.}
\renewcommand{\thesubsection}{\thesection\arabic{subsection}}

% load caption to format captions of figures, tables, etc
\usepackage[]{caption}
% load subcaption to be able to use subfigures, subtables, etc
\usepackage{subcaption}

% load fancyhdr to format header and footer
\usepackage{fancyhdr}

% define style for simple pages without any header and footer
\fancypagestyle{plain}{
    \fancyhf{}
    \renewcommand{\headrulewidth}{0pt}
    \renewcommand{\footrulewidth}{0pt}
}

% style for homework, my personal one
\fancypagestyle{homework}{
    \fancyhead{}
    \fancyfoot{}
	\lhead{\leftmark}
	\chead{\rightmark}
	\rhead{\today}
	\lfoot{Felsenkatze}
	\cfoot{Gymnasium Neu Wulmstorf \\Ernst-Moritz-Arndt-Str. 20 \\21629 Neu
Wulmstorf \\}
	\rfoot{\thepage}
	\renewcommand{\headrulewidth}{0.4pt}
	\renewcommand{\footrulewidth}{0.4pt}
}

% style for school requirements
\fancypagestyle{school}{
    \fancyhf{}
    \cfoot{\thepage}
    \renewcommand{\headrulewidth}{0pt}
    \renewcommand{\footrulewidth}{0.4pt}
}

\pagestyle{school}

% load package to customize spacing
\usepackage{setspace}

% set spacing in quote environments to 1 and footnotesize
\expandafter\def\expandafter\quote\expandafter{\quote\singlespacing\footnotesize}

% load footmisc to customize footnotes
% bottom sets the footnote to the real bottom of the page, not the end of the text
% hang indents the footnotetext enough so that it is not continued under the footnotenumber
% set multiple to be able to distungish between several footnotes at same position (instead of ^1213, it is ^12,13)
\usepackage[bottom, hang, multiple]{footmisc}
% set spacing in footnotes to single
\renewcommand{\footnotelayout}{\setstretch{1}}

\usepackage{pdfpages}

% load ragged2e for customization of text alignment
\usepackage[document]{ragged2e}

% load blindtext for testing purposes
\usepackage{blindtext}

% set lenght used by pandoc when converting lists
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}

% define command for use with signatures
% it produces two lines to write on, each 5cm wide
% got it from here: https://stackoverflow.com/questions/1436061/how-to-make-a-signature-field-in-latex
\newcommand{\doubleSignature}[2]{
  \begin{minipage}[c]{\textwidth}
  \vspace{2cm}
  \makebox[12cm][c]{
  \hfill \makebox[6cm][c] {\hrulefill} \hfill \makebox[5cm][c] {\hrulefill} \hfill
  }
  \makebox[12cm][c]{
  \hfill #2 \hfill #1 \hfill
  }
  \vspace{1cm}
  \end{minipage}
  }

% include optional statements from yaml in the preamble

\title{Deutsche Küche}
\author{Felsenkatze\and}
\date{\today}

\begin{document}

\onehalfspacing % set line spacing 1.5

\pagestyle{plain}
\vspace*{2cm}

\begin{center}
  {\huge Deutsche Küche}\\[1cm]
  {\LARGE Die Herangehensweise an die Aufnahme von Essen mit besonderem
Bezug zu fleischlichen Schnabulaten}\\[5cm]
\end{center}

\vspace*{2cm}

\begin{tabular}{p{3.5cm}|p{0.1cm} p{10cm}l}
  \textsc{Name:}                   &  & \textsc{Felsenkatze}   \\
  \textsc{Fach:}      &  & \textsc{Futtern}  \\ 
  
  
  
  \textsc{Lehrkraft:} &  & \textsc{Fr.~Gulo Gulo}  \\ 
  \textsc{TutorIn:}     &  & \textsc{Hr. Vielfraß}    \\ 
  \textsc{Abgabedatum:}  &  & \textsc{\today}     \\ 
\end{tabular}

\vspace*{4cm}

\begin{center}
  Gymnasium Neu Wulmstorf \\Ernst-Moritz-Arndt-Str. 20 \\21629 Neu
Wulmstorf \\
\end{center}
\clearpage
\pagestyle{school}

\startcontents
\pagestyle{plain}
\printcontents{}{1}{\section*{Inhaltsverzeichnis}}
\clearpage
\pagestyle{school}

\nocite{*}

\blinddocument

% commands executed before the appendix section
\clearpage
\startcontents[appendix]
\printcontents[appendix]{}{2}{\section{Anhang}}
\stopcontents
\clearpage
\renewcommand{\thesubsection}{A\arabic{subsection}}
% the 'real' appendix
\includepdf[pages=1, addtotoc={1, subsection, 2, Felsenkatze Website, felsenkatze-web}, pagecommand={\thispagestyle{school}}]{felsenkatze.pdf}
% commands executed after the appendix section
\stopcontents[appendix]
\resumecontents

\section{Quellen}
\renewcommand{\thesubsection}{\thesection\arabic{subsection}}
\refstepcounter{subsection}
\defbibnote{stepCounter}{\setstretch{0}\refstepcounter{subsection}}
\printbibliography[heading=subbibintoc,postnote=stepCounter,type=book,title={\thesection\arabic{subsection}\quad Bücher}]
\printbibliography[heading=subbibintoc,postnote=stepCounter,type=incollection,title={\thesection\arabic{subsection}\quad Sammelbände}]
\printbibliography[heading=subbibintoc,postnote=stepCounter,type=article,title={\thesection\arabic{subsection}\quad Artikel}]
\printbibliography[heading=subbibintoc,postnote=stepCounter,type=online,title={\thesection\arabic{subsection}\quad Internet}]
\printbibliography[heading=subbibintoc,postnote=stepCounter,type=video,title={\thesection\arabic{subsection}\quad Videos}]
\printbibliography[heading=subbibintoc,postnote=stepCounter,nottype=book,nottype=incollection,nottype=article,nottype=online,nottype=video,title={\thesection\arabic{subsection}\quad Andere}]
\section{Versicherung}
Hiermit versichere ich, dass ich meine Facharbeit selbstständig
angefertigt, keine anderen als die angegebenen Hilfsmittel benutzt und
die Stellen der Facharbeit, die im Wortlaut oder im wesentlichen Inhalt
aus anderen Werken übernommen wurden, mit genauer Quellenangabe
kenntlich gemacht habe.

Mir ist bekannt, dass nicht ordnungsgemäße Quellenangaben und/ oder die
Verwendung von nicht angegebenen Arbeiten oder Hilfsmitteln als
Täuschungsversuch gewertet werden.

\doubleSignature{(Unterschrift)}{(Ort, Datum)}

\section{Einverständniserklärung}
Hiermit erkläre ich, dass ich damit einverstanden bin / nicht damit
einverstanden bin (Nichtzutreffendes auslassen!), wenn die von mir
verfasste Facharbeit gegebenenfalls der schulinternen Öffentlichkeit
zugänglich gemacht wird.

\doubleSignature{(Unterschrift)}{(Ort, Datum)}

\end{document}